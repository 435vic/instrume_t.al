{{> page/nav }}

<h1 class="title">Instruments</h1>
<div class="fixed-grid has-1-cols-mobile has-2-cols-tablet has-3-cols-desktop">
    <div class="grid is-gap-5 px-5">
    {{#each instruments}}
        <div class="cell" id="instrument-cell-{{this.id}}">
            <div class="card">
                <div class="card-image">
                    <figure class="image is-4by3">
                        <img src="https://bulma.io/assets/images/placeholders/1280x960.png" alt="Placeholder image">
                    </figure>
                </div>
                <div class="card-content">
                    <p class="title">{{this.name}}</p>
                    <p class="subtitle">{{this.origin_date}}</p>
                    <p class="content">{{this.description}}</p>
                </div>
                {{#if (isAdmin ../user)}}
                <footer class="card-footer">
                    <div class="card-footer-item">
                        <button class="button" onclick="handleCardButton(this)" data-action="edit" data-forInstrument="{{this.id}}"><span class="icon">✏️</span></button>
                    </div>
                    <div class="card-footer-item">
                        <button class="button" onclick="handleCardButton(this)" data-action="delete" data-forInstrument="{{this.id}}"><span class="icon">🗑️</span></button>
                    </div>
                </footer>
                {{/if}}
            </div>
        </div>
    {{/each}}
    </div>
</div>

<nav class="pagination is-centered" role="pagination" aria-label="pagination">
<ul class="pagination-list">
    {{#each pages}}
        <li><a href="?page={{this}}" class="pagination-link {{#if (isCurrentPage this)}}is-current{{/if}}">{{this}}</a></li>
    {{/each}}
</ul>
</nav>

<script>
    const params = new URLSearchParams(window.location.search);
    const page = params.get('page');
    const pageCount = {{totalPages}};
    if (parseInt(page) > pageCount) {
        history.replaceState(null, '', 'instruments');
    }
</script>
<script src="/static/js/instruments.js"></script>
